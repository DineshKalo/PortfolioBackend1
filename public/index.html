<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio CMS Admin</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .admin-panel {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: none;
        }
        
        h1, h2, h3 {
            color: #333;
            margin-bottom: 20px;
        }
        
        h1 {
            text-align: center;
            color: #667eea;
        }
        
        h3 {
            color: #667eea;
            font-size: 18px;
            margin-top: 30px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .add-form {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 2px dashed #667eea;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .password-input-wrapper {
            position: relative;
        }
        
        .password-input-wrapper input {
            padding-right: 45px;
        }
        
        .password-toggle {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px 8px;
            color: #666;
            font-size: 20px;
            line-height: 1;
            display: flex;
            align-items: center;
        }
        
        .password-toggle:hover {
            color: #333;
        }
        
        .eye-icon {
            width: 20px;
            height: 20px;
            display: inline-block;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="date"],
        input[type="file"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
            padding: 8px 16px;
            font-size: 12px;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
            margin-left: 10px;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-block {
            width: 100%;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #ddd;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .current-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }
        
        .current-label {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
            display: block;
        }
        
        .item-list {
            margin-top: 20px;
        }
        
        .item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: start;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .item-content {
            flex: 1;
        }
        
        .item-content strong {
            display: block;
            color: #333;
            margin-bottom: 5px;
        }
        
        .item-content small {
            color: #666;
            display: block;
            margin-top: 5px;
        }
        
        .item-meta {
            color: #999;
            font-size: 12px;
            margin-top: 8px;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
            margin-left: 15px;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .gallery-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            background: white;
        }
        
        .gallery-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .gallery-item-info {
            padding: 10px;
        }
        
        .gallery-item-caption {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .gallery-item-order {
            font-size: 11px;
            color: #999;
        }
        
        .gallery-item-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }
        
        .message {
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }
        
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .message.show {
            display: block;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
        
        .hidden {
            display: none;
        }
        
        .link {
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
        }
        
        .link:hover {
            color: #5568d3;
        }
        
        .current-image {
            max-width: 300px;
            max-height: 300px;
            object-fit: cover;
            border-radius: 8px;
            margin-top: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .hero-image-preview {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 8px;
            margin-top: 10px;
        }
        
        .image-actions {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
            background: white;
            border-radius: 8px;
            border: 2px dashed #ddd;
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .badge-success {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .bilingual-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .language-panel {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
        }

        .language-panel h4 {
            margin-bottom: 10px;
            color: #667eea;
        }

        .translate-btn {
            background: #17a2b8;
            color: white;
            margin-top: 10px;
        }

        .translate-btn:hover {
            background: #138496;
        }

        @media (max-width: 768px) {
            .bilingual-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .item {
                flex-direction: column;
            }
            
            .item-actions {
                margin-left: 0;
                margin-top: 10px;
                width: 100%;
            }
        }

        @media (max-width: 768px) {
    .about-side-by-side {
        grid-template-columns: 1fr !important;
    }
}

.journey-item-bilingual {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-top: 10px;
}

.journey-item-lang {
    padding: 10px;
    background: #f8f9fa;
    border-radius: 5px;
}

.journey-item-lang strong {
    display: block;
    color: #667eea;
    margin-bottom: 5px;
    font-size: 12px;
    text-transform: uppercase;
}

/* Responsive layout for smaller screens */
@media (max-width: 768px) {
    .journey-item-bilingual {
        grid-template-columns: 1fr !important;
    }
}

/* Dual Language Inputs */
.dual-language-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 15px;
}

.language-input-group {
    display: flex;
    flex-direction: column;
}

.language-input-group input[dir="rtl"] {
    text-align: right;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* Dual Language Display */
.dual-language-display {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 20px;
}

.language-column h4 {
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 2px solid #e0e0e0;
    color: #333;
    text-align: center;
}

.language-column:last-child h4 {
    border-bottom-color: #2196f3;
}

.language-column:last-child .item {
    text-align: right;
    direction: rtl;
}

.language-column:last-child .item-content {
    text-align: right;
}

.language-column:last-child .item-meta {
    text-align: left;
    direction: ltr;
}

.language-column:last-child .badge {
    direction: ltr;
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Form -->
        <div class="login-container" id="loginContainer">
            <h1>Portfolio CMS Login</h1>
            <div class="message" id="loginMessage"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="loginPassword" required>
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('loginPassword', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Login</button>
                <p style="text-align: center; margin-top: 15px;">
                    <span class="link" onclick="showForgotPassword()">Forgot Password?</span>
                </p>
            </form>
        </div>

        <!-- Forgot Password Form -->
        <div class="login-container hidden" id="forgotContainer">
            <h1>Reset Password</h1>
            <div class="message" id="forgotMessage"></div>
            <form id="forgotForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="forgotEmail" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Send Reset Link</button>
                <p style="text-align: center; margin-top: 15px;">
                    <span class="link" onclick="showLogin()">Back to Login</span>
                </p>
            </form>
        </div>

        <!-- Reset Password Form -->
        <div class="login-container hidden" id="resetContainer">
            <h1>Set New Password</h1>
            <div class="message" id="resetMessage"></div>
            <form id="resetForm">
                <div class="form-group">
                    <label>New Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="resetPassword" required minlength="6">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('resetPassword', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="resetPasswordConfirm" required minlength="6">
                        <button type="button" class="password-toggle" onclick="togglePasswordVisibility('resetPasswordConfirm', this)">
                            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Reset Password</button>
            </form>
        </div>

        <!-- Admin Panel -->
        <div class="admin-panel" id="adminPanel">
            <div class="header">
                <h1>Portfolio CMS Admin</h1>
                <button class="btn btn-danger" onclick="logout()">Logout</button>
            </div>

            <div class="message" id="adminMessage"></div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('hero', event)">Hero Section</button>
                <button class="tab" onclick="switchTab('about', event)">About</button>
                <button class="tab" onclick="switchTab('journey', event)">Journey</button>
                <button class="tab" onclick="switchTab('experience', event)">Experience</button>
                <button class="tab" onclick="switchTab('testimonials', event)">Testimonials</button>
                <button class="tab" onclick="switchTab('gallery', event)">Gallery</button>
                <button class="tab" onclick="switchTab('contact', event)">Contact</button>
            </div>

            <!-- Hero Tab -->
            <div class="tab-content active" id="heroTab">
                <div class="section">
                    <h2>Hero Section (Landing Page)</h2>
                    
                    <h3>Current Hero Section</h3>
                    <div class="current-content">
                        <div id="currentHero">
                            <p><strong>Title:</strong> <span id="currentHeroTitle"></span></p>
                            <p><strong>Subtitle:</strong> <span id="currentHeroSubtitle"></span></p>
                            <div id="currentHeroImageContainer"></div>
                        </div>
                    </div>

                    <h3>Update Hero Text</h3>
                    <div class="add-form">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 13px; color: #1976d2;">
                            ℹ️ <strong>Auto-Translation:</strong> Enter text in English. Arabic translation will be generated automatically.
                        </div>
                        <form id="heroTextForm">
                            <div class="info-box">
                                ℹ️ <strong>Manual Entry:</strong> Enter text in both English and Arabic.
                            </div>
                            
                            <!-- Language Tabs
                            <div class="language-tabs">
                                <button type="button" class="lang-tab active" onclick="switchLangTab('hero', 'en', event)">English</button>
                                <button type="button" class="lang-tab" onclick="switchLangTab('hero', 'ar', event)">Arabic</button>
                            </div> -->
                            
                            <!-- English Content -->
                            <div class="lang-content active" id="heroLangEn">
                                <div class="form-group">
                                    <label>Title (English)</label>
                                    <input type="text" id="heroTitleEn" placeholder="Welcome to My Portfolio">
                                </div>
                                <div class="form-group">
                                    <label>Subtitle (English)</label>
                                    <input type="text" id="heroSubtitleEn" placeholder="Creative Professional">
                                </div>
                            </div>
                            
                            <!-- Arabic Content -->
                            <div class="lang-content" id="heroLangAr">
                                <div class="form-group">
                                    <label>Title (Arabic)</label>
                                    <input type="text" id="heroTitleAr" placeholder="مرحبا بكم في محفظتي" dir="rtl">
                                </div>
                                <div class="form-group">
                                    <label>Subtitle (Arabic)</label>
                                    <input type="text" id="heroSubtitleAr" placeholder="محترف مبدع" dir="rtl">
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success">Update Hero Text</button>
                        </form>
                    </div>

                    <h3>Hero Background Image</h3>
                    <div class="add-form">
                        <form id="heroImageForm">
                            <div class="form-group">
                                <label>Upload Background Image (Max 10MB)</label>
                                <input type="file" id="heroImage" accept="image/*">
                            </div>
                            <button type="submit" class="btn btn-success">Upload Background Image</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- About Tab -->
            <div class="tab-content" id="aboutTab">
                <div class="section">
                    <h2>About Section</h2>
                    
                    <h3>Current About Content</h3>
                    <div class="current-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <span class="current-label">English:</span>
                                <div id="currentAboutEn" style="color: #666; white-space: pre-wrap;"></div>
                            </div>
                            <div>
                                <span class="current-label">Arabic:</span>
                                <div id="currentAboutAr" style="color: #666; white-space: pre-wrap;" dir="rtl"></div>
                            </div>
                        </div>
                        <div id="currentProfileImageContainer"></div>
                    </div>

                    <h3>Update About Content</h3>
                    <div class="add-form">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 13px; color: #1976d2;">
                            ℹ️ <strong>Manual Entry:</strong> Enter text in both English and Arabic side by side.
                        </div>
                        <form id="aboutForm">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <!-- English Side -->
                                <div class="form-group">
                                    <label>Content (English) *</label>
                                    <textarea id="aboutContentEn" placeholder="Enter about section content..." style="min-height: 200px;" required></textarea>
                                </div>
                                
                                <!-- Arabic Side -->
                                <div class="form-group">
                                    <label>Content (Arabic) *</label>
                                    <textarea id="aboutContentAr" placeholder="أدخل محتوى قسم حول" style="min-height: 200px;" dir="rtl" required></textarea>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-success">Save About</button>
                        </form>
                    </div>

                    <h3>Profile Picture</h3>
                    <div class="add-form">
                        <form id="profileImageForm">
                            <div class="form-group">
                                <label>Upload Profile Picture (Max 5MB)</label>
                                <input type="file" id="profileImage" accept="image/*">
                            </div>
                            <button type="submit" class="btn btn-success">Upload Profile Picture</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Journey Tab -->
            <div class="tab-content" id="journeyTab">
                <div class="section">
                    <h2>Journey / Timeline</h2>
                    
                    <h3>Add New Journey Item</h3>
                    <div class="add-form">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 13px; color: #1976d2;">
                            ℹ️ <strong>Manual Entry:</strong> Enter text in both English and Arabic side by side.
                        </div>
                        <form id="journeyForm">
                            <input type="hidden" id="journeyId">
                            
                            <div class="form-group">
                                <label>Age / Year *</label>
                                <input type="text" id="journeyAge" placeholder="e.g., Age 18, 2020, Year 5" required>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <!-- English Side -->
                                <div>
                                    <div class="form-group">
                                        <label>Title (English) *</label>
                                        <input type="text" id="journeyTitleEn" placeholder="e.g., Started University" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Description (English) *</label>
                                        <textarea id="journeyBodyEn" placeholder="Enter a paragraph describing this milestone..." style="min-height: 150px;" required></textarea>
                                    </div>
                                </div>
                                
                                <!-- Arabic Side -->
                                <div>
                                    <div class="form-group">
                                        <label>Title (Arabic) *</label>
                                        <input type="text" id="journeyTitleAr" placeholder="مثال: بدأت الجامعة" dir="rtl" required>
                                    </div>
                                    <div class="form-group">
                                        <label>Description (Arabic) *</label>
                                        <textarea id="journeyBodyAr" placeholder="أدخل فقرة تصف هذا الإنجاز..." style="min-height: 150px;" dir="rtl" required></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Display Order</label>
                                <input type="number" id="journeyOrder" value="0" placeholder="0 = first">
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn btn-success" id="journeySubmitBtn">Add Journey Item</button>
                                <button type="button" class="btn btn-secondary hidden" id="cancelJourneyEdit" onclick="cancelEditJourney()">Cancel</button>
                            </div>
                        </form>
                    </div>
                    
                    <h3>All Journey Items (<span id="journeyCount">0</span>)</h3>
                    <div class="item-list" id="journeyList"></div>
                </div>
            </div>

            <!-- Experience Tab -->
            <div class="tab-content" id="experienceTab">
                <div class="section">
                    <h2>Experience & Certifications</h2>
                    
                    <h3>Add New Experience</h3>
                    <div class="add-form">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 13px; color: #1976d2;">
                            ℹ️ <strong>Manual Entry:</strong> Enter text in both English and Arabic side by side.
                        </div>
                        <form id="experienceForm">
                            <input type="hidden" id="expId">
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <!-- English Side -->
                                <div>
                                    <div class="form-group">
                                        <label>Name (English) *</label>
                                        <input type="text" id="expNameEn" placeholder="e.g., Bachelor of Science in Computer Science" required>
                                    </div>
                                </div>
                                
                                <!-- Arabic Side -->
                                <div>
                                    <div class="form-group">
                                        <label>Name (Arabic) *</label>
                                        <input type="text" id="expNameAr" placeholder="مثل: بكالوريوس علوم الحاسب الآلي" dir="rtl" required>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Date</label>
                                <input type="date" id="expDate">
                            </div>
                            
                            <div class="form-group checkbox-group">
                                <input type="checkbox" id="expInProgress" onchange="toggleDateField()">
                                <label style="margin: 0;">In Progress</label>
                            </div>
                            
                            <div class="form-group">
                                <label>Display Order</label>
                                <input type="number" id="expOrder" value="0" placeholder="0 = first">
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn btn-success" id="expSubmitBtn">Add Experience</button>
                                <button type="button" class="btn btn-secondary hidden" id="cancelExpEdit" onclick="cancelEditExperience()">Cancel</button>
                            </div>
                        </form>
                    </div>

                    <h3>All Experiences (<span id="expCount">0</span>)</h3>
                    <div class="item-list" id="experienceList"></div>
                </div>
            </div>

            <!-- Testimonials Tab -->
            <div class="tab-content" id="testimonialsTab">
                <div class="section">
                    <h2>Client Testimonials</h2>
                    
                    <h3>Add New Testimonial</h3>
                    <div class="add-form">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 13px; color: #1976d2;">
                            ℹ️ <strong>Manual Entry:</strong> Enter text in both English and Arabic side by side.
                        </div>
                        <form id="testimonialForm">
                            <input type="hidden" id="testId">
                            
                            <div class="form-group">
                                <label>Client Name *</label>
                                <input type="text" id="testName" placeholder="e.g., John Doe" required>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                <!-- English Side -->
                                <div>
                                    <div class="form-group">
                                        <label>Comment/Review (English) *</label>
                                        <textarea id="testCommentEn" placeholder="Enter client testimonial in English..." style="min-height: 120px;" required></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label>Activity/Package (English)</label>
                                        <input type="text" id="testPackageEn" placeholder="e.g., Website Development Package">
                                    </div>
                                </div>
                                
                                <!-- Arabic Side -->
                                <div>
                                    <div class="form-group">
                                        <label>Comment/Review (Arabic) *</label>
                                        <textarea id="testCommentAr" placeholder="أدخل شهادة العميل بالعربية..." style="min-height: 120px;" dir="rtl" required></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label>Activity/Package (Arabic)</label>
                                        <input type="text" id="testPackageAr" placeholder="مثل: باقة تطوير الموقع الإلكتروني" dir="rtl">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Display Order</label>
                                <input type="number" id="testOrder" value="0" placeholder="0 = first">
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn btn-success" id="testSubmitBtn">Add Testimonial</button>
                                <button type="button" class="btn btn-secondary hidden" id="cancelTestEdit" onclick="cancelEditTestimonial()">Cancel</button>
                            </div>
                        </form>
                    </div>

                    <h3>All Testimonials (<span id="testCount">0</span>)</h3>
                    <div class="item-list" id="testimonialList"></div>
                </div>
            </div>

            <!-- Gallery Tab -->
            <div class="tab-content" id="galleryTab">
                <div class="section">
                    <h2>Gallery</h2>
                    
                    <h3>Upload New Image</h3>
                    <div class="add-form">
                        <form id="galleryForm">
                            <div class="form-group">
                                <label>Select Image (Max 5MB) *</label>
                                <input type="file" id="galleryImage" accept="image/*" required>
                            </div>
                            <div class="form-group">
                                <label>Caption (Optional)</label>
                                <input type="text" id="galleryCaption" placeholder="Enter image caption...">
                            </div>
                            <div class="form-group">
                                <label>Display Order</label>
                                <input type="number" id="galleryOrder" value="0" placeholder="0 = first">
                            </div>
                            <button type="submit" class="btn btn-success">Upload Image</button>
                        </form>
                    </div>

                    <h3>All Images (<span id="galleryCount">0</span>)</h3>
                    <div class="gallery-grid" id="galleryGrid"></div>
                </div>
            </div>

            <!-- Contact Tab -->
            <div class="tab-content" id="contactTab">
                <div class="section">
                    <h2>Contact Information</h2>
                    
                    <h3>Current Contact Details</h3>
                    <div class="current-content">
                        <div id="currentContact" style="color: #666;"></div>
                    </div>

                    <h3>Update Contact Information</h3>
                    <div class="add-form">
                        <form id="contactForm">
                            <div class="form-group">
                                <label>Name</label>
                                <input type="text" id="contactName" placeholder="Your full name">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="contactEmail" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label>Instagram Handle</label>
                                <input type="text" id="contactInsta" placeholder="username">
                            </div>
                            <button type="submit" class="btn btn-success">Save Contact Info</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = '/api';
        let token = localStorage.getItem('adminToken');

        window.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const resetToken = urlParams.get('token');
            if (resetToken) {
                showResetPassword(resetToken);
            } else if (token) {
                showAdminPanel();
            }
        });

        function showLogin() {
            document.getElementById('loginContainer').classList.remove('hidden');
            document.getElementById('forgotContainer').classList.add('hidden');
            document.getElementById('resetContainer').classList.add('hidden');
        }

        function showForgotPassword() {
            document.getElementById('loginContainer').classList.add('hidden');
            document.getElementById('forgotContainer').classList.remove('hidden');
        }

        function showResetPassword(resetToken) {
            document.getElementById('loginContainer').classList.add('hidden');
            document.getElementById('resetContainer').classList.remove('hidden');
            document.getElementById('resetContainer').dataset.token = resetToken;
        }

        function showAdminPanel() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('forgotContainer').style.display = 'none';
            document.getElementById('resetContainer').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            loadAllData();
        }

        function switchTab(tabName, event) {
            document.querySelectorAll('.tab').forEach(function(tab) {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(function(content) {
                content.classList.remove('active');
            });
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        function togglePasswordVisibility(inputId, button) {
            const input = document.getElementById(inputId);
            
            if (input.type === 'password') {
                input.type = 'text';
                button.innerHTML = '<svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>';
            } else {
                input.type = 'password';
                button.innerHTML = '<svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>';
            }
        }

        function showMessage(elementId, message, isError) {
            const el = document.getElementById(elementId);
            el.textContent = message;
            el.className = 'message show ' + (isError ? 'error' : 'success');
            setTimeout(function() {
                el.classList.remove('show');
            }, 5000);
        }

        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const res = await fetch(API_URL + '/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: email, password: password })
                });
                const data = await res.json();

                if (res.ok) {
                    token = data.token;
                    localStorage.setItem('adminToken', token);
                    showAdminPanel();
                } else {
                    showMessage('loginMessage', data.message, true);
                }
            } catch (error) {
                showMessage('loginMessage', 'Login failed', true);
            }
        });

        document.getElementById('forgotForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;

            try {
                const res = await fetch(API_URL + '/auth/forgot-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: email })
                });
                const data = await res.json();
                showMessage('forgotMessage', data.message, !res.ok);
            } catch (error) {
                showMessage('forgotMessage', 'Request failed', true);
            }
        });

        document.getElementById('resetForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const password = document.getElementById('resetPassword').value;
            const confirm = document.getElementById('resetPasswordConfirm').value;
            const resetToken = document.getElementById('resetContainer').dataset.token;

            if (password !== confirm) {
                showMessage('resetMessage', 'Passwords do not match', true);
                return;
            }

            try {
                const res = await fetch(API_URL + '/auth/reset-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ token: resetToken, newPassword: password })
                });
                const data = await res.json();

                if (res.ok) {
                    showMessage('resetMessage', data.message + ' Redirecting to login...', false);
                    setTimeout(function() {
                        window.location.href = '/';
                    }, 2000);
                } else {
                    showMessage('resetMessage', data.message, true);
                }
            } catch (error) {
                showMessage('resetMessage', 'Reset failed', true);
            }
        });

        function logout() {
            localStorage.removeItem('adminToken');
            token = null;
            window.location.reload();
        }

        async function apiCall(endpoint, method, body, isFormData) {
            const headers = { 'Authorization': 'Bearer ' + token };
            if (!isFormData) headers['Content-Type'] = 'application/json';

            const options = { method: method, headers: headers };
            if (body) options.body = isFormData ? body : JSON.stringify(body);

            const res = await fetch(API_URL + endpoint, options);
            if (res.status === 401) {
                logout();
                return;
            }
            return res.json();
        }

        async function loadAllData() {
            loadHero();
            loadAbout();
            loadJourney();
            loadExperiences();
            loadTestimonials();
            loadGallery();
            loadContact();
        }
        // HERO Tab
        async function loadHero() {
            const data = await fetch(API_URL + '/hero').then(r => r.json());
            
            const titleEn = (data.title && data.title.en) ? data.title.en : 'Not set';
            const titleAr = (data.title && data.title.ar) ? data.title.ar : 'غير محدد';
            const subtitleEn = (data.subtitle && data.subtitle.en) ? data.subtitle.en : 'Not set';
            const subtitleAr = (data.subtitle && data.subtitle.ar) ? data.subtitle.ar : 'غير محدد';
            
            // Display both languages
            document.getElementById('currentHeroTitleEn').textContent = titleEn;
            document.getElementById('currentHeroTitleAr').textContent = titleAr;
            document.getElementById('currentHeroSubtitleEn').textContent = subtitleEn;
            document.getElementById('currentHeroSubtitleAr').textContent = subtitleAr;
            
            // Populate form fields
            document.getElementById('heroTitleEn').value = titleEn;
            document.getElementById('heroTitleAr').value = titleAr;
            document.getElementById('heroSubtitleEn').value = subtitleEn;
            document.getElementById('heroSubtitleAr').value = subtitleAr;
        }

        document.getElementById('heroTextForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const titleEn = document.getElementById('heroTitleEn').value;
            const titleAr = document.getElementById('heroTitleAr').value;
            const subtitleEn = document.getElementById('heroSubtitleEn').value;
            const subtitleAr = document.getElementById('heroSubtitleAr').value;
            
            // Validation
            if (!titleEn || !titleAr || !subtitleEn || !subtitleAr) {
                showMessage('adminMessage', 'Please fill in both English and Arabic fields', true);
                return;
            }
            
            // Send bilingual data
            const hero = {
                title: { en: titleEn, ar: titleAr },
                subtitle: { en: subtitleEn, ar: subtitleAr }
            };
            
            const data = await apiCall('/hero', 'PUT', hero);
            showMessage('adminMessage', data.message);
            loadHero();
        });

        document.getElementById('heroImageForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const fileInput = document.getElementById('heroImage');
            
            if (!fileInput.files[0]) {
                showMessage('adminMessage', 'Please select an image', true);
                return;
            }
            
            const formData = new FormData();
            formData.append('image', fileInput.files[0]);

            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Uploading...';
            submitBtn.disabled = true;

            try {
                const data = await apiCall('/hero/background-image', 'POST', formData, true);
                showMessage('adminMessage', data.message);
                e.target.reset();
                loadHero();
            } catch (error) {
                showMessage('adminMessage', 'Upload failed', true);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        async function deleteHeroImage() {
            if (!confirm('Are you sure you want to delete the hero background image?')) return;
            const data = await apiCall('/hero/background-image', 'DELETE');
            showMessage('adminMessage', data.message);
            loadHero();
        }


        // About Tab
        async function loadAbout() {
            const data = await fetch(API_URL + '/about').then(function(r) { return r.json(); });
            
            const contentEn = (data.content && data.content.en) ? data.content.en : 'No content yet';
            const contentAr = (data.content && data.content.ar) ? data.content.ar : 'لا يوجد محتوى بعد';
            
            document.getElementById('currentAboutEn').textContent = contentEn;
            document.getElementById('currentAboutAr').textContent = contentAr;
            document.getElementById('aboutContentEn').value = contentEn !== 'No content yet' ? contentEn : '';
            document.getElementById('aboutContentAr').value = contentAr !== 'لا يوجد محتوى بعد' ? contentAr : '';
            
            const imageContainer = document.getElementById('currentProfileImageContainer');
            if (data.profileImageUrl) {
                imageContainer.innerHTML = '<div style="margin-top: 15px;"><span class="current-label">Current Profile Picture:</span><br><img src="' + data.profileImageUrl + '" class="current-image" alt="Profile Picture"><div class="image-actions"><button class="btn btn-danger btn-small" onclick="deleteProfileImage()">Delete Profile Picture</button></div></div>';
            } else {
                imageContainer.innerHTML = '<p style="margin-top: 10px; color: #999;">No profile picture set</p>';
            }
        }

        document.getElementById('aboutForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const contentEn = document.getElementById('aboutContentEn').value.trim();
            const contentAr = document.getElementById('aboutContentAr').value.trim();
            
            if (!contentEn || !contentAr) {
                showMessage('adminMessage', 'Please fill in both English and Arabic content', true);
                return;
            }
            
            const aboutData = {
                content: { en: contentEn, ar: contentAr }
            };
            
            const data = await apiCall('/about', 'PUT', aboutData);
            showMessage('adminMessage', data.message);
            loadAbout();
        });

        document.getElementById('profileImageForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const fileInput = document.getElementById('profileImage');
            
            if (!fileInput.files[0]) {
                showMessage('adminMessage', 'Please select an image', true);
                return;
            }
            
            const formData = new FormData();
            formData.append('image', fileInput.files[0]);

            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Uploading...';
            submitBtn.disabled = true;

            try {
                const data = await apiCall('/about/profile-image', 'POST', formData, true);
                showMessage('adminMessage', data.message);
                e.target.reset();
                loadAbout();
            } catch (error) {
                showMessage('adminMessage', 'Upload failed', true);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        async function deleteProfileImage() {
            if (!confirm('Are you sure you want to delete the profile picture?')) return;
            const data = await apiCall('/about/profile-image', 'DELETE');
            showMessage('adminMessage', data.message);
            loadAbout();
        }


        // Journey Tab
        async function loadJourney() {
            const data = await fetch(API_URL + '/journey').then(function(r) { return r.json(); });
            const list = document.getElementById('journeyList');
            document.getElementById('journeyCount').textContent = data.length;
            
            if (data.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">🗺️</div><p>No journey items added yet. Add your first milestone above!</p></div>';
                return;
            }
            
            list.innerHTML = data.map(function(item) {
                // Get both English and Arabic content
                const titleEn = (item.title && item.title.en) ? item.title.en : (typeof item.title === 'string' ? item.title : 'Untitled');
                const titleAr = (item.title && item.title.ar) ? item.title.ar : '';
                const bodyEn = (item.body && item.body.en) ? item.body.en : (typeof item.body === 'string' ? item.body : '');
                const bodyAr = (item.body && item.body.ar) ? item.body.ar : '';
                
                const bodyEnPreview = bodyEn.substring(0, 100) + (bodyEn.length > 100 ? '...' : '');
                const bodyArPreview = bodyAr.substring(0, 100) + (bodyAr.length > 100 ? '...' : '');
                
                const itemStr = JSON.stringify(item);
                const itemStrEscaped = itemStr.replace(/"/g, '&quot;');
                
                return '<div class="item">' +
                    '<div class="item-content">' +
                        '<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">' +
                            '<span class="badge badge-success">' + item.age + '</span>' +
                            '<span style="color: #999; font-size: 11px;">Order: ' + item.order + ' | Added: ' + new Date(item.createdAt).toLocaleDateString() + '</span>' +
                        '</div>' +
                        '<div class="journey-item-bilingual">' +
                            '<div class="journey-item-lang">' +
                                '<strong>English</strong>' +
                                '<div style="font-weight: 600; margin-bottom: 5px;">' + titleEn + '</div>' +
                                '<small style="color: #666;">' + bodyEnPreview + '</small>' +
                            '</div>' +
                            '<div class="journey-item-lang">' +
                                '<strong>Arabic</strong>' +
                                '<div style="font-weight: 600; margin-bottom: 5px;" dir="rtl">' + (titleAr || 'غير متوفر') + '</div>' +
                                '<small style="color: #666;" dir="rtl">' + (bodyArPreview || 'غير متوفر') + '</small>' +
                            '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="item-actions">' +
                        '<button class="btn btn-primary btn-small" onclick="editJourney(' + itemStrEscaped + ')">Edit</button>' +
                        '<button class="btn btn-danger btn-small" onclick="deleteJourney(\'' + item._id + '\')">Delete</button>' +
                    '</div>' +
                '</div>';
            }).join('');
        }

        document.getElementById('journeyForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const id = document.getElementById('journeyId').value;
            
            const titleEn = document.getElementById('journeyTitleEn').value.trim();
            const titleAr = document.getElementById('journeyTitleAr').value.trim();
            const bodyEn = document.getElementById('journeyBodyEn').value.trim();
            const bodyAr = document.getElementById('journeyBodyAr').value.trim();
            const age = document.getElementById('journeyAge').value.trim();
            
            if (!titleEn || !titleAr || !bodyEn || !bodyAr || !age) {
                showMessage('adminMessage', 'Please fill in all required fields in both languages', true);
                return;
            }
            
            const journey = {
                age: age,
                title: { en: titleEn, ar: titleAr },
                body: { en: bodyEn, ar: bodyAr },
                order: parseInt(document.getElementById('journeyOrder').value) || 0
            };

            const data = id ? await apiCall('/journey/' + id, 'PUT', journey) : await apiCall('/journey', 'POST', journey);

            showMessage('adminMessage', data.message);
            e.target.reset();
            document.getElementById('journeyId').value = '';
            document.getElementById('journeySubmitBtn').textContent = 'Add Journey Item';
            document.getElementById('cancelJourneyEdit').classList.add('hidden');
            loadJourney();
        });

        function editJourney(item) {
            document.getElementById('journeyId').value = item._id;
            document.getElementById('journeyAge').value = item.age;
            
            // Extract both English and Arabic content
            const titleEn = (item.title && item.title.en) ? item.title.en : (typeof item.title === 'string' ? item.title : '');
            const titleAr = (item.title && item.title.ar) ? item.title.ar : '';
            const bodyEn = (item.body && item.body.en) ? item.body.en : (typeof item.body === 'string' ? item.body : '');
            const bodyAr = (item.body && item.body.ar) ? item.body.ar : '';
            
            document.getElementById('journeyTitleEn').value = titleEn;
            document.getElementById('journeyTitleAr').value = titleAr;
            document.getElementById('journeyBodyEn').value = bodyEn;
            document.getElementById('journeyBodyAr').value = bodyAr;
            document.getElementById('journeyOrder').value = item.order;
            
            document.getElementById('journeySubmitBtn').textContent = 'Update Journey Item';
            document.getElementById('cancelJourneyEdit').classList.remove('hidden');
            document.getElementById('journeyForm').scrollIntoView({ behavior: 'smooth' });
        }

        async function deleteJourney(id) {
            if (!confirm('Are you sure you want to delete this journey item?')) return;
            const data = await apiCall('/journey/' + id, 'DELETE');
            showMessage('adminMessage', data.message);
            loadJourney();
        }

        function cancelEditJourney() {
            document.getElementById('journeyForm').reset();
            document.getElementById('journeyId').value = '';
            document.getElementById('journeySubmitBtn').textContent = 'Add Journey Item';
            document.getElementById('cancelJourneyEdit').classList.add('hidden');
        }


        //Experience tab
        async function loadExperiences() {
            const data = await fetch(API_URL + '/experience').then(function(r) { return r.json(); });
            const list = document.getElementById('experienceList');
            document.getElementById('expCount').textContent = data.length;
            
            if (data.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">📋</div><p>No experiences added yet. Add your first experience above!</p></div>';
                return;
            }
            
            list.innerHTML = data.map(function(exp) {
                const nameEn = (exp.name && exp.name.en) ? exp.name.en : exp.name;
                const nameAr = (exp.name && exp.name.ar) ? exp.name.ar : '';
                
                return `<div class="item">
                    <div class="item-content">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px;">
                            <div>
                                <strong style="display: block; margin-bottom: 8px;">English:</strong>
                                <strong>${nameEn}</strong>
                            </div>
                            <div style="text-align: right; direction: rtl;">
                                <strong style="display: block; margin-bottom: 8px;">العربية:</strong>
                                <strong>${nameAr || 'No Arabic text'}</strong>
                            </div>
                        </div>
                        ${exp.inProgress ? '<span class="badge badge-warning">In Progress</span>' : ''}
                        <small>${exp.inProgress ? 'In Progress' : (exp.date || 'No date specified')}</small>
                        <div class="item-meta">Order: ${exp.order} | Added: ${new Date(exp.createdAt).toLocaleDateString()}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick='editExperience(${JSON.stringify(exp)})'>Edit</button>
                        <button class="btn btn-danger btn-small" onclick="deleteExperience('${exp._id}')">Delete</button>
                    </div>
                </div>`;
            }).join('');
        }

        function toggleDateField() {
            const checkbox = document.getElementById('expInProgress');
            const dateInput = document.getElementById('expDate');
            dateInput.disabled = checkbox.checked;
            if (checkbox.checked) dateInput.value = '';
        }

        document.getElementById('experienceForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const id = document.getElementById('expId').value;
            const exp = {
                name: {
                    en: document.getElementById('expNameEn').value,
                    ar: document.getElementById('expNameAr').value
                },
                date: document.getElementById('expDate').value,
                inProgress: document.getElementById('expInProgress').checked,
                order: parseInt(document.getElementById('expOrder').value)
            };

            const data = id ? await apiCall('/experience/' + id, 'PUT', exp) : await apiCall('/experience', 'POST', exp);

            showMessage('adminMessage', data.message);
            e.target.reset();
            document.getElementById('expId').value = '';
            document.getElementById('expSubmitBtn').textContent = 'Add Experience';
            document.getElementById('cancelExpEdit').classList.add('hidden');
            loadExperiences();
        });

        function editExperience(exp) {
            document.getElementById('expId').value = exp._id;
            
            // Set both English and Arabic values
            document.getElementById('expNameEn').value = (exp.name && exp.name.en) ? exp.name.en : exp.name || '';
            document.getElementById('expNameAr').value = (exp.name && exp.name.ar) ? exp.name.ar : '';
            
            document.getElementById('expDate').value = exp.date || '';
            document.getElementById('expInProgress').checked = exp.inProgress;
            document.getElementById('expOrder').value = exp.order;
            document.getElementById('expSubmitBtn').textContent = 'Update Experience';
            document.getElementById('cancelExpEdit').classList.remove('hidden');
            toggleDateField();
            document.getElementById('experienceForm').scrollIntoView({ behavior: 'smooth' });
        }

        async function deleteExperience(id) {
            if (!confirm('Are you sure you want to delete this experience?')) return;
            const data = await apiCall('/experience/' + id, 'DELETE');
            showMessage('adminMessage', data.message);
            loadExperiences();
        }

        function cancelEditExperience() {
            document.getElementById('experienceForm').reset();
            document.getElementById('expId').value = '';
            document.getElementById('expSubmitBtn').textContent = 'Add Experience';
            document.getElementById('cancelExpEdit').classList.add('hidden');
        }


        //Testimonials tab
        async function loadTestimonials() {
            const data = await fetch(API_URL + '/testimonial').then(function(r) { return r.json(); });
            const list = document.getElementById('testimonialList');
            document.getElementById('testCount').textContent = data.length;
            
            if (data.length === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-state-icon">💬</div><p>No testimonials added yet. Add your first testimonial above!</p></div>';
                return;
            }
            
            list.innerHTML = data.map(function(test) {
                const commentEn = (test.comment && test.comment.en) ? test.comment.en : test.comment;
                const commentAr = (test.comment && test.comment.ar) ? test.comment.ar : '';
                const packageEn = (test.activityPackage && test.activityPackage.en) ? test.activityPackage.en : test.activityPackage;
                const packageAr = (test.activityPackage && test.activityPackage.ar) ? test.activityPackage.ar : '';
                
                return `<div class="item">
                    <div class="item-content">
                        <strong>${test.name}</strong>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0;">
                            <!-- English Content -->
                            <div>
                                <strong style="display: block; margin-bottom: 8px; color: #666; font-size: 12px;">English:</strong>
                                ${packageEn ? `<span class="badge badge-success">${packageEn}</span>` : ''}
                                <small>"${commentEn}"</small>
                            </div>
                            
                            <!-- Arabic Content -->
                            <div style="text-align: right; direction: rtl;">
                                <strong style="display: block; margin-bottom: 8px; color: #666; font-size: 12px;">العربية:</strong>
                                ${packageAr ? `<span class="badge badge-success">${packageAr}</span>` : ''}
                                <small>"${commentAr || 'No Arabic text'}"</small>
                            </div>
                        </div>
                        
                        <div class="item-meta">Order: ${test.order} | Added: ${new Date(test.createdAt).toLocaleDateString()}</div>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-primary btn-small" onclick='editTestimonial(${JSON.stringify(test)})'>Edit</button>
                        <button class="btn btn-danger btn-small" onclick="deleteTestimonial('${test._id}')">Delete</button>
                    </div>
                </div>`;
            }).join('');
        }

        document.getElementById('testimonialForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const id = document.getElementById('testId').value;
            const test = {
                name: document.getElementById('testName').value,
                comment: {
                    en: document.getElementById('testCommentEn').value,
                    ar: document.getElementById('testCommentAr').value
                },
                activityPackage: {
                    en: document.getElementById('testPackageEn').value,
                    ar: document.getElementById('testPackageAr').value
                },
                order: parseInt(document.getElementById('testOrder').value)
            };

            const data = id ? await apiCall('/testimonial/' + id, 'PUT', test) : await apiCall('/testimonial', 'POST', test);

            showMessage('adminMessage', data.message);
            e.target.reset();
            document.getElementById('testId').value = '';
            document.getElementById('testSubmitBtn').textContent = 'Add Testimonial';
            document.getElementById('cancelTestEdit').classList.add('hidden');
            loadTestimonials();
        });

        function editTestimonial(test) {
            document.getElementById('testId').value = test._id;
            document.getElementById('testName').value = test.name;
            
            // Set both English and Arabic values
            document.getElementById('testCommentEn').value = (test.comment && test.comment.en) ? test.comment.en : test.comment || '';
            document.getElementById('testCommentAr').value = (test.comment && test.comment.ar) ? test.comment.ar : '';
            
            document.getElementById('testPackageEn').value = (test.activityPackage && test.activityPackage.en) ? test.activityPackage.en : test.activityPackage || '';
            document.getElementById('testPackageAr').value = (test.activityPackage && test.activityPackage.ar) ? test.activityPackage.ar : '';
            
            document.getElementById('testOrder').value = test.order;
            document.getElementById('testSubmitBtn').textContent = 'Update Testimonial';
            document.getElementById('cancelTestEdit').classList.remove('hidden');
            document.getElementById('testimonialForm').scrollIntoView({ behavior: 'smooth' });
        }

        async function deleteTestimonial(id) {
            if (!confirm('Are you sure you want to delete this testimonial?')) return;
            const data = await apiCall('/testimonial/' + id, 'DELETE');
            showMessage('adminMessage', data.message);
            loadTestimonials();
        }

        function cancelEditTestimonial() {
            document.getElementById('testimonialForm').reset();
            document.getElementById('testId').value = '';
            document.getElementById('testSubmitBtn').textContent = 'Add Testimonial';
            document.getElementById('cancelTestEdit').classList.add('hidden');
        }

        //Gallery tab
        async function loadGallery() {
            const data = await fetch(API_URL + '/gallery').then(function(r) { return r.json(); });
            const grid = document.getElementById('galleryGrid');
            document.getElementById('galleryCount').textContent = data.length;
            
            if (data.length === 0) {
                grid.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><div class="empty-state-icon">🖼️</div><p>No images uploaded yet. Upload your first image above!</p></div>';
                return;
            }
            
            grid.innerHTML = data.map(function(img) {
                return '<div class="gallery-item"><img src="' + img.imageUrl + '" alt="' + (img.caption || 'Gallery image') + '"><div class="gallery-item-info"><div class="gallery-item-caption">' + (img.caption || 'No caption') + '</div><div class="gallery-item-order">Order: ' + img.order + ' | ' + new Date(img.createdAt).toLocaleDateString() + '</div></div><div class="gallery-item-actions"><button class="btn btn-danger btn-small" onclick="deleteImage(\'' + img._id + '\')" title="Delete image">×</button></div></div>';
            }).join('');
        }

        document.getElementById('galleryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const fileInput = document.getElementById('galleryImage');
            
            if (!fileInput.files[0]) {
                showMessage('adminMessage', 'Please select an image', true);
                return;
            }
            
            const formData = new FormData();
            formData.append('image', fileInput.files[0]);
            formData.append('caption', document.getElementById('galleryCaption').value);
            formData.append('order', document.getElementById('galleryOrder').value);

            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Uploading...';
            submitBtn.disabled = true;

            try {
                const data = await apiCall('/gallery', 'POST', formData, true);
                showMessage('adminMessage', data.message);
                e.target.reset();
                loadGallery();
            } catch (error) {
                showMessage('adminMessage', 'Upload failed', true);
            } finally {
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        });

        async function deleteImage(id) {
            if (!confirm('Are you sure you want to delete this image? This will also remove it from Cloudinary.')) return;
            const data = await apiCall('/gallery/' + id, 'DELETE');
            showMessage('adminMessage', data.message);
            loadGallery();
        }

        //CONTACTS Tab
        async function loadContact() {
            const data = await fetch(API_URL + '/contact').then(function(r) { return r.json(); });
            
            const currentContact = document.getElementById('currentContact');
            if (!data.name && !data.email && !data.instagramHandle) {
                currentContact.innerHTML = '<p style="color: #999;">No contact information set yet.</p>';
            } else {
                currentContact.innerHTML = '<p><strong>Name:</strong> ' + (data.name || 'Not set') + '</p><p><strong>Email:</strong> ' + (data.email || 'Not set') + '</p><p><strong>Instagram:</strong> ' + (data.instagramHandle || 'Not set') + '</p>';
            }
            
            document.getElementById('contactName').value = data.name || '';
            document.getElementById('contactEmail').value = data.email || '';
            document.getElementById('contactInsta').value = data.instagramHandle || '';
        }

        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const contact = {
                name: document.getElementById('contactName').value,
                email: document.getElementById('contactEmail').value,
                instagramHandle: document.getElementById('contactInsta').value
            };
            const data = await apiCall('/contact', 'PUT', contact);
            showMessage('adminMessage', data.message);
            loadContact();
        });
    </script>
</body>
</html>